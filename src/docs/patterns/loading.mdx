import { DemoCard, ImageGrid, MaterialDesignDescription, Divider, TOC } from '../../app/components';
import LoadingBanner from '../../app/assets/design-patterns/loading-states/loading-banner.svg';
import Skeleton from '../../app/assets/design-patterns/loading-states/skeleton.gif';
import Wave from '../../app/assets/design-patterns/loading-states/wave.gif';
import Pulsate from '../../app/assets/design-patterns/loading-states/pulsate.gif';
import OverlaySpinner from '../../app/assets/design-patterns/loading-states/overlay-spinner.png';
import InlineSpinner from '../../app/assets/design-patterns/form-validation/verify-on-submit.gif';
import MiniSpinner from '../../app/assets/design-patterns/loading-states/mini-spinner.png';
import ProgressBar from '../../app/assets/design-patterns/loading-states/progress-bar.gif';
import Specs from '../../app/assets/design-patterns/loading-states/specs-1.png';

<!-- KEYWORDS: design pattern loading asynchronous api refresh -->

# Loading & Waiting

<ImageGrid images={[LoadingBanner]} regularWidth />

Oftentimes, your application will need to load data from (or send data to) a remote location with some amount of latency. When this happens, you will need to provide some indication to the user that something is happening. Different situations may call for different styles of indicator, explained below.

<React.Fragment>
    <MaterialDesignDescription
        title={'Progress Indicators'}
        url={`https://material.io/components/progress-indicators`}
    />
    <TOC
        anchors={[
            { title: 'Introduction' },
            { title: 'Variations' },
            { title: 'Skeleton', hash: '#placeholder-shapes--skeleton', depth: 1 },
            { title: 'Spinner Overlays', depth: 1 },
            { title: 'Contextual Spinners', depth: 1 },
            { title: 'Progress Bars', depth: 1 },
            { title: 'Behaviors' },
            { title: 'Design Specifications' },
            { title: 'Developers' },
        ]}
    />
    <Divider />
</React.Fragment>

# Variations

There are a number of different ways to indicate to a user that something is happening / loading behind the scenes. Different variations are appropriate in different situations.

## Placeholder Shapes / Skeleton

<ImageGrid
    images={[Skeleton]}
    caption={['When your application is loading structured data, use skeletons to tell your user what to expect.']}
    regularWidth
/>

When loading data for the first time, you do not want to show an empty screen while you are fetching the data. Instead, you should show placeholder shapes ("skeletons") that mimic the data that will eventually be loaded. This will give the impression that your application is faster and gives users an indication of what kind of data is being loaded.

<DemoCard
    repository={'Skeletons'}
    angular={`https://stackblitz.com/github/brightlayer-ui/angular-design-patterns/tree/master?file=src%2Fapp%2Fpages%2Floading-waiting-states%2Fskeleton-loader%2Fskeleton-loader.component.html`}
    react={`https://codesandbox.io/s/github/brightlayer-ui/react-design-patterns/tree/master?file=/src/pages/loading-waiting-states/skeletons/Skeletons.tsx&initialpath=skeletons`}
    reactNative
/>

The skeleton should match as closely as possible the real _structure_ of the data, using shapes like rectangles and circles. The data _length_, however, may not be available at the time of loading, and it is likely that your skeleton ended up looking slightly different from your real data. This is OK; your mission is only to set up users' expectations.

<ImageGrid
    images={[Wave, Pulsate]}
    caption={[
        'Skeletons are usually animated, to indicate that the application is still running and responding. There are two kinds of skeleton animations.',
        '1: Wave, where a gradient is animated from side to side over gray shapes.',
        '2: Pulsate, where the brightness of the gray shapes is animated periodically.',
    ]}
/>

## Spinner Overlays

Spinner overlays make use of a semi-transparent overlay with a large, centered spinner. This variation of indicators is useful when you want to block user interaction with the screen (or a section of the screen) while processing occurs.

<ImageGrid
    regularWidth
    images={[OverlaySpinner]}
    caption={['1: Use of overlay spinner when loading EULA.', '2. Remove the overlay once the data is loaded.']}
/>

<DemoCard
    repository={'Spinner Overlays'}
    angular={`https://stackblitz.com/github/brightlayer-ui/angular-design-patterns/tree/master?file=src%2Fapp%2Fpages%2Floading-waiting-states%2Fspinner-overlays%2Fspinner-overlays.component.html`}
    react={`https://codesandbox.io/s/github/brightlayer-ui/react-design-patterns/tree/master?file=/src/pages/loading-waiting-states/spinner-overlays/index.tsx&initialpath=spinner-overlays`}
    reactNative
/>

## Contextual Spinners

Contextual spinners can be used as an alternative to spinner overlays in certain situations. The most common application of contextual spinners is during [Form](/patterns/forms) submission / verification. If you need to wait for a server response to validate inputs in a form (after clicking the submit button), you should disable the submit button and replace its label with a spinner. If the verification succeeds, the application should proceed to the next screen. If verification fails, the appropriate error messages should be displayed and the submit button label restored.

<ImageGrid
    images={[InlineSpinner]}
    regularWidth
    caption={[
        'After the user clicks the submit button, the app waits for the server response, and displays an error message.',
    ]}
/>

<DemoCard
    repository={'Contextual Spinner'}
    angular={`https://stackblitz.com/github/brightlayer-ui/angular-design-patterns/tree/master?file=src%2Fapp%2Fpages%2Floading-waiting-states%2Fcontextual-spinners%2Fcontextual-spinners.component.html`}
    react={`https://codesandbox.io/s/github/brightlayer-ui/react-design-patterns/tree/master?file=/src/pages/loading-waiting-states/contextual-spinner/ContextualSpinner.tsx&initialpath=contextual-spinner`}
    reactNative
/>

## Progress Bars

<ImageGrid
    images={[ProgressBar]}
    caption={'Use progress bar when the progress is measurable, such as when the user is uploading a known-sized file.'}
/>

Progress bars should be used sparingly in your application. They should only be used in situations where progress is discrete / measurable. For example, it could be used to indicate progress when uploading a file to a server.

<DemoCard
    repository={'Progress Bar'}
    angular={`https://stackblitz.com/github/brightlayer-ui/angular-design-patterns/tree/master?file=src%2Fapp%2Fpages%2Floading-waiting-states%2Fprogress-bars%2Fprogress-bars.component.html`}
    react={`https://codesandbox.io/s/github/brightlayer-ui/react-design-patterns/tree/master?file=/src/pages/loading-waiting-states/progress-bar/index.tsx&initialpath=progress-bar`}
    reactNative
/>

<DemoCard
    repository={'Indeterminate Progress Bar'}
    angular={`https://stackblitz.com/github/brightlayer-ui/angular-design-patterns/tree/master?file=src%2Fapp%2Fpages%2Floading-waiting-states%2Fprogress-bar-indeterminate%2Fprogress-bar-indeterminate.component.html`}
    react={`https://codesandbox.io/s/github/brightlayer-ui/react-design-patterns/tree/master?file=/src/pages/loading-waiting-states/progress-bar-indeterminate/index.tsx&initialpath=progress-bar-indeterminate`}
    reactNative
/>

<Divider />

# Behaviors

## Real-time Data (Polling / Pub-Sub)

If you are showing real-time data (either via polling or a push mechanism from the server), there is no need to show loading indicators. If you wish, you can display a small indicator when data is being refreshed or mention somewhere on the screen when the data was last refreshed so users can identify if the data is stale. You should avoid showing a loading indicator if your data is refreshed more than once per minute.

<ImageGrid
    regularWidth
    images={[MiniSpinner]}
    caption={'You can place a small loading icon in the header when data is updating.'}
/>

## Manual Refresh

If your users can manually refresh data on the screen, you may wish to show the placeholder elements (as with initial load), or simply refresh the data behind the scenes without indication (as with real-time). Ultimately, this should depend on how long it takes to refresh the data - if it takes more than one second to load the data, you should use an indicator.

<Divider />

# Design Specifications

Context plays an important role in sizing your indicators. If you are using them in a small container, you may need to scale down from the recommended size.

<React.Fragment>
    <ImageGrid
        regularWidth
        images={[Specs]}
        caption={[
            '1. Overlay spinners should default to size 96.',
            '2. Contextual button spinners should use size 20.',
        ]}
    />
    <Divider />
</React.Fragment>

# Developers

## Placeholder Shapes / Skeleton

There are a number of libraries available to help you create placeholder shapes, such as:

**Angular**:

-   [@netbasal/ngx-content-loader](https://www.npmjs.com/package/@netbasal/ngx-content-loader)
-   [placeholder-loading](https://www.npmjs.com/package/placeholder-loading)

**Ionic**:

-   [@netbasal/ngx-content-loader](https://www.npmjs.com/package/@netbasal/ngx-content-loader)
-   [placeholder-loading](https://www.npmjs.com/package/placeholder-loading)
-   [ion-skeleton-text](https://ionicframework.com/docs/api/skeleton-text)

**React**:

-   [placeholder-loading](https://www.npmjs.com/package/placeholder-loading)
-   [react-content-loader](https://www.npmjs.com/package/react-content-loader)
-   [@material-ui/lab/Skeleton](https://mui.com/components/skeleton/#skeleton)

**React Native**:

-   [rn-placeholder](https://www.npmjs.com/package/rn-placeholder)

## Progress Indicators

Additionally, you should use the following progress / spinner components:

**Angular** and **Ionic** - Angular Material:

-   [Progress Spinner](https://material.angular.io/components/progress-spinner/overview)
-   [Progress Bar](https://material.angular.io/components/progress-bar/overview)

**React** - Material UI:

-   [Circular Progress](https://mui.com/components/progress/#circular)
-   [Linear Progress](https://mui.com/components/progress/#linear)

**React Native** - React Native Paper:

-   [Activity Indicator](https://callstack.github.io/react-native-paper/activity-indicator.html)
-   [Progress Bar](https://callstack.github.io/react-native-paper/progress-bar.html)
